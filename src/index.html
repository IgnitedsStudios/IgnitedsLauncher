<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" type="image/png" href="./img/icon/logo.png">
  <title>Igniteds Launcher</title>
</head>
<body>
  <div class="App">
    <header class="App-header">
      <img src="./img/logo.png" class="logo" alt="logo" />
      <h1 class="title">Loading...</h1> <!-- Texto por defecto mientras carga el JSON -->
    </header>
    <div class="content">
      <button class="start-button" onclick="handleStartClick()">
        <img id="dynamicImage" src="./img/start.png" alt="Start" />
      </button>
      <button class="download-button" onclick="handleDownloadClick()">Download Packs</button>
    </div>
  </div>

  <script>
    let packsUrl = '#'; // Variable para almacenar la URL de los packs
    let serverUrl = 'minecraft://connect?serverUrl=NONE&serverPort=NONE';
    // Función para cargar el archivo JSON y actualizar el título y la URL de los packs
    function loadEventData() {
      fetch('https://raw.githubusercontent.com/IgnitedsStudios/IgnitedsLauncher/main/src/event.json')
        .then(response => response.json())
        .then(data => {
          const { eventName, packs, ip, port } = data;
          // Actualiza el contenido del h1 con el nombre del evento
          document.querySelector('h1.title').textContent = eventName;
          serverUrl = `minecraft://connect?serverUrl=${ip}&serverPort=${port}`
          // Almacena la URL de los packs
          packsUrl = packs;
        })
        .catch(error => {
          console.error('Error al cargar el archivo JSON:', error);
        });
    }

    // Llama a la función para cargar los datos cuando la página se carga
    window.onload = loadEventData;

    let showGif = false;
    let timerEnded = false;
    function handleStartClick() {
      // Cambia la imagen a GIF al hacer clic
      document.getElementById('dynamicImage').src = './img/start.gif';

      // Temporizador para ocultar el GIF y abrir el juego
      setTimeout(() => {
        document.getElementById('dynamicImage').src = './img/start.png'; // Restablecer la imagen
        timerEnded = true;

        if (timerEnded) {
          // Aquí abres el juego (esto es un ejemplo, necesitarás definir cómo abrir el juego)
          window.location.href = serverUrl;
          window.close();
        }
      }, 800); // Ajusta el tiempo según sea necesario
    }

    function handleDownloadClick() {
      // Usa la URL de los packs almacenada en la variable packsUrl
      if (packsUrl) {
        window.open(packsUrl, '_self');
      } else {
        console.error('URL de los packs no disponible.');
      }
    }
  </script>
</body>
</html>